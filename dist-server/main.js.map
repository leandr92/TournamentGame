{"version":3,"sources":["../src/main.js"],"names":["express","require","socketIO","path","PORT","process","env","INDEX","join","__dirname","server","requestHandler","listen","console","log","io","gameEngine","SpaaaceGameEngine","traceLevel","Lib","Trace","TRACE_NONE","serverEngine","SpaaaceServerEngine","debug","updateRate","timeoutInterval","get","req","res","sendFile","processInput","query","Number","id","gameObjects","Object","keys","world","objects","element","type","playerId","gameObject","postiton","position","angle","gameFieldWidth","worldSettings","width","gameFieldHeight","height","push","send","use","start"],"mappings":"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","sourcesContent":["const express = require('express');\r\nconst socketIO = require('socket.io');\r\nconst path = require('path');\r\nimport { Lib } from 'lance-gg';\r\n\r\nconst PORT = process.env.PORT || 3000;\r\nconst INDEX = path.join(__dirname, '../dist/index.html');\r\n\r\n// Game Server\r\nimport SpaaaceServerEngine from './server/SpaaaceServerEngine.js';\r\nimport SpaaaceGameEngine from './common/SpaaaceGameEngine.js';\r\n\r\n// define routes and socket\r\nconst server = express();\r\n\r\nlet requestHandler = server.listen(PORT, () => console.log(`Listening on ${ PORT }`));\r\nconst io = socketIO(requestHandler);\r\n\r\n// Game Instances\r\nconst gameEngine = new SpaaaceGameEngine({ traceLevel: Lib.Trace.TRACE_NONE });\r\nconst serverEngine = new SpaaaceServerEngine(io, gameEngine, {\r\n    debug: {},\r\n    updateRate: 6,\r\n    timeoutInterval: 0 // no timeout\r\n});\r\n\r\n\r\nserver.get('/', function(req, res) { res.sendFile(INDEX); });\r\nserver.get('/api', function(req, res) {\r\n    //ar InputData = { input: \"up\" };\r\n    gameEngine.processInput(req.query, Number(req.query.id));\r\n\r\n    let gameObjects = [];\r\n\r\n    for (let element of Object.keys(gameEngine.world.objects)) {\r\n\r\n        let type = \"\";\r\n\r\n        if (gameEngine.world.objects[element].playerId != req.query.id) {\r\n            type = \"Enemy\";\r\n        } else {\r\n            type = \"Me\";\r\n        }\r\n\r\n        let gameObject = {\r\n            postiton: gameEngine.world.objects[element].position,\r\n            type: type,\r\n            id: gameEngine.world.objects[element].id,\r\n            angle: gameEngine.world.objects[element].angle,\r\n            gameFieldWidth: gameEngine.worldSettings.width,\r\n            gameFieldHeight: gameEngine.worldSettings.height\r\n        }\r\n\r\n        gameObjects.push(gameObject);\r\n\r\n    }\r\n\r\n    res.send(gameObjects);\r\n});\r\nserver.use('/', express.static(path.join(__dirname, '../dist/')));\r\n\r\n\r\n// start the game\r\nserverEngine.start();"],"file":"main.js"}